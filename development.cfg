[buildout]
parts +=
    supervisor

extends =
    buildouts/base.cfg
    versions.cfg

[hosts]
externalIP =  163.1.141.102
internalIP = 10.2.0.102
servername = mlgb3-dev2.bodleian.ox.ac.uk
mysql = localhost
solr = 127.0.1.1

[ports]
apache = 7777
mysql = 3306
solr = 1234

[user]
buildout-user = ${env:USER}

[env]
recipe = gocept.recipe.env

[supervisor]
recipe = collective.recipe.supervisor
programs =
    10 solr_reindex export MLGBADMINPW=blessing; ${buildout:directory}/parts/jobs/reindex.sh > ${buildout:directory}/parts/jobs/reindex.log 2>&1;
    20 solr_daemon daemon --chdir='${buildout:directory}/parts/solr/' --command "java -Dsolr.solr.home=${buildout:directory}/parts/solr/solr -jar start.jar" --respawn --output=${buildout:directory}/parts/solr/logs/solr.log --name=solr --verbose;
    30 apache sudo ${buildout:directory}/parts/apache/bin/apachectl start;